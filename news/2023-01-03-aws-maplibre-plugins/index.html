<!DOCTYPE html><html lang="en" data-astro-cid-sckkx6r4> <head><base href="/"><meta charset="UTF-8"><meta name="generator" content="Astro v5.1.0"><link rel="icon" type="image/svg+xml" href="favicon.ico"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="MapLibre"><meta name="description"><!-- <ClientRouter /> --><meta property="og:image" content="https://maplibre.org/img/share-image.png"><meta property="og:image:width" content="1024"><meta property="og:image:height" content="512"><meta property="og:image:alt" content="MapLibre"><meta property="og:title" content="Developing Plugins for MapLibre Interoperability"><meta property="og:description"><meta property="og:url" content="https://maplibre.org/news/2023-01-03-aws-maplibre-plugins/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@maplibre"><meta name="twitter:creator" content="@maplibre"><meta name="twitter:title" content="Developing Plugins for MapLibre Interoperability"><meta name="twitter:description"><meta name="twitter:image:src" content="https://maplibre.org/img/share-image.png"><meta name="twitter:image:alt" content="MapLibre"><link rel="manifest" href="site.webmanifest"><link rel="me" href="https://mastodon.social/@maplibre"><link rel="preload" href="files/alata-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://demotiles.maplibre.org/style.json" as="fetch" crossorigin><link rel="preload" href="https://demotiles.maplibre.org/tiles/tiles.json" as="fetch" crossorigin><link rel="alternate" type="application/rss+xml" title="MapLibre" href="https://maplibre.org/news/index.xml"><title>
      Developing Plugins for MapLibre Interoperability | MapLibre
    </title><link rel="stylesheet" href="/_astro/_slug_.CtymVqLH.css">
<style>[data-astro-image]{width:100%;height:auto;object-fit:var(--fit);object-position:var(--pos);aspect-ratio:var(--w) / var(--h)}[data-astro-image=responsive]{max-width:calc(var(--w) * 1px);max-height:calc(var(--h) * 1px)}[data-astro-image=fixed]{width:calc(var(--w) * 1px);height:calc(var(--h) * 1px)}
</style>
<link rel="stylesheet" href="/_astro/maplibre-gl.D9eDo_3g.css"></head> <body data-astro-cid-sckkx6r4> <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script> <nav class="navbar navbar-expand-lg navbar-dark {{ if not .fullscreen }}
    bg-navbar
  {{ else }}
    bg-fullscreen
  {{ end }}"> <div class="container"> <a class="navbar-brand" href="" aria-label="MapLibre"> <img src="/_astro/maplibre-logo.wyLiUNdu_1QmCmX.svg" alt="MapLibre Logo" width="120" height="30" loading="lazy" decoding="async"> </a> <div class="d-flex"> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> </div> <div class="collapse navbar-collapse justify-content-end" id="navbarNavAltMarkup"> <div class="navbar-nav"> <li><a class="nav-link" href="about">About</a></li> <li><a class="nav-link" href="jobs">Jobs</a></li> <li><a class="nav-link" href="roadmap">Roadmap</a></li> <li><a class="nav-link" href="sponsors">Sponsors</a></li> <li><a class="nav-link" href="news">News</a></li> <li><a class="nav-link" href="community">Community</a></li> </div> </div> </div> </nav>  <div class="container-fluid px-0 mb-3"> <div class="row mx-0 bg-title text-center align-items-center"> <h1 class="text-white pt-6"> Developing Plugins for MapLibre Interoperability </h1> </div> </div> <div class="container"> <div class="row justify-content-center"> <div class="col-md-10 col-lg-8"> <p style="color: #9b91d2; margin: 0;"> Jan 4, 2023 </p> <div>
Categories: <a href="categories/community-post"> <span class="badge bg-light">Community-post</span> </a> </div> <div style="margin-bottom: 20px;">
Authors:  </div> <p>Considering that MapLibre is an open-source fork of the Mapbox rendering library, many of the Mapbox plugins can be used in conjunction with MapLibre without any issue in JavaScript. However, since MapLibre is a TypeScript library in the same spirit, if you wish to use some of the popular Mapbox plugins in your TypeScript application you will likely run into the TypeScript compiler throwing a lot of type inference errors. This is because these plugins were developed with Mapbox solely in mind.</p>
<p>To quickly step over these compiler complaints you may reach for the all powerful <code>@ts-ignore</code> to do something like this when using <a href="https://github.com/mapbox/mapbox-gl-draw">@mapbox/mapbox-gl-draw</a>:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="typescript"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> maplibregl </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> &quot;maplibre-gl&quot;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> MapboxDraw </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> &quot;@mapbox/mapbox-gl-draw&quot;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#9ECBFF"> &quot;maplibre-gl/dist/maplibre-gl.css&quot;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#9ECBFF"> &quot;@mapbox/mapbox-gl-draw/dist/mapbox-gl-draw.css&quot;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> map</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#E1E4E8"> maplibregl.</span><span style="color:#B392F0">Map</span><span style="color:#E1E4E8">({ </span><span style="color:#F97583">...</span><span style="color:#E1E4E8">someConfig });</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> drawCtl</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> MapboxDraw</span><span style="color:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// @ts-ignore</span></span>
<span class="line"><span style="color:#E1E4E8">map.</span><span style="color:#B392F0">addControl</span><span style="color:#E1E4E8">(drawCtl, </span><span style="color:#9ECBFF">&quot;top-left&quot;</span><span style="color:#E1E4E8">);</span></span></code></pre>
<p>Currently, we need to do this because when using TypeScript the plugin makes the assumption that it should receive reference to a Mapbox Map object rather than a MapLibre Map object. So, we must explicitly tell the TypeScript compiler to ignore this static type check. This should be a very scary band-aid to developers because if the two implementations of the map objects diverge into different directions over time it can break compatibility with this plugin. Additionally if that were to happen, no warnings or errors will surface because we are suppressing the complaint from the compiler with the all powerful <code>@ts-ignore</code>.</p>
<p>In order to avoid what could be an illusive bug in the future and to add compatibility for both MapLibre and Mapbox libraries, there is a solution! We at MapLibre recommend updating existing plugins and building new plugins to support both libraries. Here are some of the ways we can achieve that.</p>
<p>Both recommendations include using TypeScriptâ€™s implementation of Intersection Types which combines multiple types into one allowing you to add together existing types to get a single type that has all the features you need. The first example below shows how to accomplish this using default imports from the mapping libraries and the second example outlines how to accomplish the same effect with named imports.</p>
<h3 id="example-1-intersection-types-with-default-imports">Example 1: Intersection Types with Default Imports</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="typescript"><code><span class="line"><span style="color:#6A737D">// Mapbox GL Geocoder</span></span>
<span class="line"><span style="color:#6A737D">// GitHub: https://github.com/mapbox/mapbox-gl-geocoder</span></span>
<span class="line"><span style="color:#6A737D">// Types: https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/mapbox__mapbox-gl-geocoder/index.d.ts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> mapboxgl </span><span style="color:#F97583">=</span><span style="color:#F97583"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;mapbox-gl&quot;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> maplibregl </span><span style="color:#F97583">=</span><span style="color:#F97583"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;maplibre-gl&quot;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">type</span><span style="color:#B392F0"> MapGl</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> mapboxgl</span><span style="color:#F97583"> &amp;</span><span style="color:#B392F0"> maplibregl</span><span style="color:#E1E4E8">;</span></span></code></pre>
<h3 id="example-2-intersection-types-with-named-imports">Example 2: Intersection Types with Named Imports</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="typescript"><code><span class="line"><span style="color:#6A737D">// Mapbox GL Draw</span></span>
<span class="line"><span style="color:#6A737D">// GitHub: https://github.com/mapbox/mapbox-gl-draw</span></span>
<span class="line"><span style="color:#6A737D">// Types: https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/mapbox__mapbox-gl-draw/index.d.ts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { IControl </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> MapboxIControl, Map </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> MapboxMap } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> &#39;mapbox-gl&#39;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { IControl </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> MaplibreIControl, Map </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> MaplibreMap } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> &#39;maplibre-gl&#39;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">type</span><span style="color:#B392F0"> IControl</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> MapboxIControl</span><span style="color:#F97583"> &amp;</span><span style="color:#B392F0"> MaplibreIControl</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">type</span><span style="color:#B392F0"> Map</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> MapboxMap</span><span style="color:#F97583"> &amp;</span><span style="color:#B392F0"> MaplibreMap</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">declare</span><span style="color:#F97583"> class</span><span style="color:#B392F0"> PluginName</span><span style="color:#F97583"> implements</span><span style="color:#B392F0"> IControl</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    ...</span></span>
<span class="line"><span style="color:#B392F0">    onAdd</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">map</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Map</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> HTMLElement</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    onRemove</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">map</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Map</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">    ...</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre> </div> </div> </div>  <footer class="mt-auto"> <div class="container pb-4 pt-6"></div> <hr> <div class="container"> <div class="row py-3"> <div class="col-4"> <a href="" aria-label="MapLibre"> <img src="/_astro/maplibre-logo.wyLiUNdu_1QmCmX.svg" alt="MapLibre" width="120" height="30" loading="lazy" decoding="async"> </a> </div> <div class="col-8"> <div class="nav justify-content-end"> <a class="nav-link text-white" href="https://maplibre.org/news/index.xml" aria-label="MapLibre RSS Feed"> <img src="/_astro/rss.BpfNCgMz_ZFQhBe.svg" alt="RSS icon" width="16" height="16" loading="lazy" decoding="async"> </a> <a class="nav-link text-white" href="https://bsky.app/profile/maplibre.org" aria-label="MapLibre on Bluesky"> <img src="/_astro/bsky.Bs-9e82V_Z2pkIsq.svg" alt="Bluesky icon" width="16" height="14" loading="lazy" decoding="async"> </a> <a class="nav-link text-white" href="https://mastodon.social/@maplibre" aria-label="MapLibre on Mastodon"> <img src="/_astro/mstdn.VB3TGhwq_14WwfG.svg" alt="Mastodon icon" width="16" height="16" loading="lazy" decoding="async"> </a> <a class="nav-link text-white" href="https://twitter.com/maplibre" aria-label="MapLibre on X"> <img src="/_astro/x.Bdz51riZ_SANgS.svg" alt="X icon" width="16" height="16" loading="lazy" decoding="async"> </a> <a class="nav-link text-white" href="https://www.linkedin.com/company/maplibre" aria-label="MapLibre on Linkedin"> <img src="/_astro/linkedin.DM6WUlcw_b4kEW.svg" alt="Linkedin icon" width="18" height="18" loading="lazy" decoding="async"> </a> <a class="nav-link text-white" href="https://github.com/MapLibre" aria-label="MapLibre on GitHub"> <img src="/_astro/gh.hI_GfVgS_hNzGB.svg" alt="GitHub icon" width="18" height="18" loading="lazy" decoding="async"> </a> </div> </div> </div> </div> </footer> </body></html>