<!DOCTYPE html><html lang="en" data-astro-cid-sckkx6r4> <head><base href="/"><meta charset="UTF-8"><meta name="generator" content="Astro v5.1.0"><link rel="icon" type="image/svg+xml" href="favicon.ico"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="MapLibre"><meta name="description" content="MapLibre GL JS v3 - Improvements to WebGL2, Terrain3D, Color spaces, Performance and more!"><!-- <ClientRouter /> --><meta property="og:image" content="https://maplibre.org/img/share-image.png"><meta property="og:image:width" content="1024"><meta property="og:image:height" content="512"><meta property="og:image:alt" content="MapLibre"><meta property="og:title" content="MapLibre GL JS v3"><meta property="og:description" content="MapLibre GL JS v3 - Improvements to WebGL2, Terrain3D, Color spaces, Performance and more!"><meta property="og:url" content="https://maplibre.org/news/2023-05-23-maplibre-gl-js-v3/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@maplibre"><meta name="twitter:creator" content="@maplibre"><meta name="twitter:title" content="MapLibre GL JS v3"><meta name="twitter:description" content="MapLibre GL JS v3 - Improvements to WebGL2, Terrain3D, Color spaces, Performance and more!"><meta name="twitter:image:src" content="https://maplibre.org/img/share-image.png"><meta name="twitter:image:alt" content="MapLibre"><link rel="manifest" href="site.webmanifest"><link rel="me" href="https://mastodon.social/@maplibre"><link rel="preload" href="files/alata-latin-400-normal.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://demotiles.maplibre.org/style.json" as="fetch" crossorigin><link rel="preload" href="https://demotiles.maplibre.org/tiles/tiles.json" as="fetch" crossorigin><title>
      MapLibre GL JS v3 | MapLibre
    </title><link rel="stylesheet" href="/_astro/_slug_.CtymVqLH.css">
<style>[data-astro-image]{width:100%;height:auto;object-fit:var(--fit);object-position:var(--pos);aspect-ratio:var(--w) / var(--h)}[data-astro-image=responsive]{max-width:calc(var(--w) * 1px);max-height:calc(var(--h) * 1px)}[data-astro-image=fixed]{width:calc(var(--w) * 1px);height:calc(var(--h) * 1px)}
</style>
<link rel="stylesheet" href="/_astro/maplibre-gl.D9eDo_3g.css"></head> <body data-astro-cid-sckkx6r4> <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script> <nav class="navbar navbar-expand-lg navbar-dark {{ if not .fullscreen }}
    bg-navbar
  {{ else }}
    bg-fullscreen
  {{ end }}"> <div class="container"> <a class="navbar-brand" href="" aria-label="MapLibre"> <img src="/_astro/maplibre-logo.wyLiUNdu_1QmCmX.svg" alt="MapLibre Logo" width="120" height="30" loading="lazy" decoding="async"> </a> <div class="d-flex"> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> </div> <div class="collapse navbar-collapse justify-content-end" id="navbarNavAltMarkup"> <div class="navbar-nav"> <li><a class="nav-link" href="about">About</a></li> <li><a class="nav-link" href="jobs">Jobs</a></li> <li><a class="nav-link" href="roadmap">Roadmap</a></li> <li><a class="nav-link" href="sponsors">Sponsors</a></li> <li><a class="nav-link" href="news">News</a></li> <li><a class="nav-link" href="community">Community</a></li> </div> </div> </div> </nav>  <div class="container-fluid px-0 mb-3"> <div class="row mx-0 bg-title text-center align-items-center"> <h1 class="text-white pt-6"> MapLibre GL JS v3 </h1> </div> </div> <div class="container"> <div class="row justify-content-center"> <div class="col-md-10 col-lg-8"> <p style="color: #9b91d2; margin: 0;"> May 23, 2023 </p> <div>
Categories: <a href="categories/announcements"> <span class="badge bg-light">Announcements</span> </a> </div> <div style="margin-bottom: 20px;">
Authors: <a href="authors/birk"> <span class="badge bg-light">Birk Skyum</span> </a> </div> <meta name="x:site" content="@maplibre"/>
<meta name="x:title" content="MapLibre GL JS v3"/>
<meta property="x:domain" content="maplibre.org"/>
<meta name="x:card" content="summary_large_image"/>
<meta property="x:url" content="https://maplibre.org/news/2023-05-23-maplibre-gl-js-v3/"/>
<meta name="x:description" content="MapLibre GL JS v3 - Improvements to Terrain3D, WebGL2, Color spaces, Performance and more!"/>
<meta name="x:image" content="https://maplibre.org/news/2023-05-23-maplibre-gl-js-v3/header.png"/>
<p>This release is a big step for MapLibre GL JS! With more than 500 commits, and almost a year in the making, version 3.0.0 is surely our best release yet. Lots of features, performance improvement, bug fixes and a few potentially breaking changes that were necessary, to keep the project healthy, are to be found here.</p>
<p><strong>A note on migration:</strong>
Most users will be able to update to v3 without code changes, but it’s recommended to read the section on potentially breaking changes in the changelog carefully to assess if you’re code needs migration.</p>
<p>Thanks for all the code contributions!</p>
<p><a href="https://github.com/rotu">@rotu</a>, <a href="https://github.com/pramilk">@pramilk</a>, <a href="https://github.com/zhangyiatmicrosoft">@zhangyiatmicrosoft</a>, <a href="https://github.com/prozessor13">@prozessor13</a>, <a href="https://github.com/Pessimistress">@Pessimistress</a>, <a href="https://github.com/ChrisLoer">@ChrisLoer</a>, <a href="https://github.com/xabbu42">@xabbu42</a>, <a href="https://github.com/VehpuS">@VehpuS</a>, <a href="https://github.com/zstadler">@zstadler</a>, <a href="https://github.com/ZeLonewolf">@ZeLonewolf</a>, <a href="https://github.com/kajkal">@kajkal</a>, <a href="https://github.com/kevinschaul">@kevinschaul</a>, <a href="https://github.com/ambientlight">@ambientlight</a>, <a href="https://github.com/smellyshovel">@smellyshovel</a>, <a href="https://github.com/kircher1">@kircher1</a>, <a href="https://github.com/tordans">@tordans</a>, <a href="https://github.com/IvanSanchez">@IvanSanchez</a>, <a href="https://github.com/acalcutt">@acalcutt</a>, <a href="https://github.com/jleedev">@jleedev</a>, <a href="https://github.com/llambanna">@llambanna</a>, <a href="https://github.com/cns-solutions-admin">@cns-solutions-admin</a>, <a href="https://github.com/vanilla-lake">@vanilla-lake</a>, <a href="https://github.com/lukashass">@lukashass</a></p>
<p>Facilitated by:</p>
<p><a href="https://github.com/HarelM">@HarelM</a>, <a href="https://github.com/BirkSkyum">@BirkSkyum</a>, <a href="https://github.com/wipfli">@wipfli</a></p>
<h1 id="notable-changes-for-this-release">Notable changes for this release</h1>
<h2 id="performance">Performance</h2>
<p>A lot of work has been put into making this version of MapLibre GL JS faster. Here are some of the highlights:</p>
<ul>
<li>Lazy load default style properties on demand to improve loading performance and reduce memory usage. (<a href="https://github.com/maplibre/maplibre-gl-js/pull/2476">#2476</a>)</li>
<li>Improve performance by sending style layers to the worker thread before processing it on the main thread to allow parallel processing (<a href="https://github.com/maplibre/maplibre-gl-js/pull/2131">#2131</a>)</li>
<li>Improve performance when forcing full symbol placement by short-circuiting pause checks (<a href="https://github.com/maplibre/maplibre-gl-js/pull/2241">#2241</a>)</li>
<li>Improve initial loading performance by lazy serializing layers only when needed. (<a href="https://github.com/maplibre/maplibre-gl-js/pull/2306">#2306</a>)</li>
<li>Add validateStyle MapOption to allow disabling style validation for faster performance in a production environment. (<a href="https://github.com/maplibre/maplibre-gl-js/pull/2390">#2390</a>)</li>
<li>Throttle the image request queue while the map is moving to improve performance (<a href="https://github.com/maplibre/maplibre-gl-js/issues/2097">#2097</a>)</li>
<li>Improve control initial loading performance by forcing fadeDuration to 0 till the first idle event (<a href="https://github.com/maplibre/maplibre-gl-js/pull/2447">#2447</a>)</li>
<li>Improve control performance by restricting worker count to a max of 1 except for Safari browser. (<a href="https://github.com/maplibre/maplibre-gl-js/pull/2354">#2354</a>)</li>
<li>Bump KDBush and supercluster for better memory efficiency (<a href="https://github.com/maplibre/maplibre-gl-js/pull/2522">#2522</a>)</li>
<li>Speed up the cross tile symbol index in certain circumstances (<a href="https://github.com/maplibre/maplibre-gl-js/pull/1755">#1755</a>)</li>
<li>Improve rendering speed in scenes with many colliding symbolic icons and labels (<a href="https://github.com/maplibre/maplibre-gl-js/pull/1757">#1757</a>)</li>
<li>Make request for ImageSource cancelable (<a href="https://github.com/maplibre/maplibre-gl-js/pull/1802">#1802</a>)</li>
<li>Prevent unnecessary reload of raster sources when RTL Text Plugin loads (<a href="https://github.com/maplibre/maplibre-gl-js/issues/2380">#2380</a>)</li>
<li>Fix event.isSourceLoaded to reflect the state of source loading for sourcedata event (<a href="https://github.com/maplibre/maplibre-gl-js/pull/2543">#2543</a>)</li>
</ul>
<h2 id="transformcameraupdate">transformCameraUpdate</h2>
<a href="https://stackblitz.com/edit/vitejs-vite-8nntze?file=src%2FMinimap.tsx"><img src="/_astro/minimap.f3K6V75G_Z1usFhv.webp" alt="minimap" style="width: 500px; max-width: 100%; height: auto;" width="1118" height="759" loading="lazy" decoding="async"></a>
<p>This new feature makes it possible to get direct access to the camera transform, and manipulate it, continuously whenever the map is attempting to change it’s viewport. It’s a small hook, but it’s very powerful. It’s especially handy for reactive frameworks, where the camera state might be put in a store which can trigger side effects like listing the points of interest currently visible on the map. Another example of when it’s relevant is when synching multiple maps, as exemplified with a demo of a minimap and a main map that drives each other here:</p>
<p>Sync two maps with the camera transform - <a href="https://stackblitz.com/edit/vitejs-vite-8nntze?file=src%2FMinimap.tsx">Minimap demo</a></p>
<br/>
<h2 id="terrain-3d">Terrain 3D</h2>
<p>The terrain is becoming more stable, with a range of improvements landing in v3.</p>
<ul>
<li>Add queryTerrainElevation allows getting terrain elevation in meters at a specific point (<a href="https://github.com/maplibre/maplibre-gl-js/pull/2264">#2264</a>)</li>
<li>Adding a <code>warnonce</code> when terrain and hillshade source are the same (<a href="https://github.com/maplibre/maplibre-gl-js/pull/2298">#2298</a>)</li>
<li>Move terrain object from style.terrain to map.terrain (<a href="https://github.com/maplibre/maplibre-gl-js/pull/1628">#1628</a>)</li>
<li>Fix the gap between terrain elevated tiles (<a href="https://github.com/maplibre/maplibre-gl-js/issues/1602">#1602</a>)</li>
<li>Fix wrap coords in <code>getTerrain</code> when <code>fitBounds</code> across the AM (<a href="https://github.com/maplibre/maplibre-gl-js/pull/2155">#2155</a>)</li>
<li>Fix <code>getElevation()</code> causing an uncaught error (<a href="https://github.com/maplibre/maplibre-gl-js/issues/1650">#1650</a>).</li>
<li>Add map.getCameraTargetElevation() (<a href="https://github.com/maplibre/maplibre-gl-js/pull/1558">#1558</a>)</li>
<li>Add <code>freezeElevation</code> to <code>AnimationOptions</code> to allow smooth camera movement in 3D (<a href="https://github.com/maplibre/maplibre-gl-js/pull/1514">#1514</a>)</li>
<li>Improve rendering of areas below sea level, and remove elevationOffset workaround (<a href="https://github.com/maplibre/maplibre-gl-js/pull/1578">#1578</a>)</li>
<li>Fix overlapping of 3D building parts when 3D Terrain is activated (<a href="https://github.com/maplibre/maplibre-gl-js/issues/2513">#2513</a>)</li>
<li>Show 3D buildings located below sea level when 3D Terrain is activated (<a href="https://github.com/maplibre/maplibre-gl-js/issues/2544">#2544</a>)</li>
</ul>
<br/>
<h2 id="webgl2">WebGL2</h2>
<p>WebGL2 has finally reached a level of browser support that allows us, and large projects like <a href="https://forum.unity.com/threads/removing-support-for-gles2-and-webgl1-in-2023-1a.1360090/">Unity</a> to embrace it fully. While WebGL2 is mostly backward compatible, it gives us lots of new features, and opportunities to improve performance through parallelization. It also removes the friction that exists when using MapLibre GL JS with libraries in the ecosystem that has moved to WebGL2 already - two examples of which can be seen in the demos below:</p>
<p><strong>Interleaved rendering of DeckGL attribute transitions</strong></p>
<a href="https://codepen.io/birkskyum-1471370946/pen/VwEBPYW"><img src="/_astro/attributetransitions.D_2u6ZCM_13YMGi.webp" alt="attributetransitions" style="width: 500px; max-width: 100%; height: auto;" width="1278" height="778" loading="lazy" decoding="async"></a>
<p>3.0.0 - <a href="https://codepen.io/birkskyum-1471370946/pen/VwEBPYW">Animating</a> - Uses WebGL2</p>
<p>2.4.0 - <a href="https://codepen.io/birkskyum-1471370946/pen/qBJyRdR">Not animating</a></p>
<br/>
<p><strong>Interleaved rendering of DeckGL GPU accelerated GridLayer</strong></p>
<a href="https://stackblitz.com/edit/vitejs-vite-asczxg?file=package.json"><img src="/_astro/gpugridlayer.2mBprqaL_Z186f04.webp" alt="gpugridlayer" style="width: 500px; max-width: 100%; height: auto;" width="1232" height="688" loading="lazy" decoding="async"></a>
<p>3.0.0 <a href="https://stackblitz.com/edit/vitejs-vite-asczxg?file=package.json">GPU Accelerated</a> - Uses WebGL2</p>
<p>2.4.0 <a href="https://stackblitz.com/edit/vitejs-vite-9scpcz?file=package.json">Breaks</a> - Browser console prints “Browser not supported”</p>
<br/>
<h2 id="color-spaces">Color spaces</h2>
<a href="https://kajkal.github.io/maplibre-gl-style-spec-color-demo/swipe.html"><img src="/_astro/colorspaces.C5qEkJH7_1A1Cek.webp" alt="colorspaces" style="width: 500px; max-width: 100%; height: auto;" width="1394" height="744" loading="lazy" decoding="async"></a>
<p>We now align better with the CSS Spec for color spaces, by using the D50 illuminant instead of the D65. This brings us more continuous color spaces with the <code>interpolate-hcl</code>. To see what that means in practice, the demo <a href="https://kajkal.github.io/maplibre-gl-style-spec-color-demo/swipe.html">here</a> is a visualization of the color spaces. You can i.e. select 3.0.0-pre.4 and 3.0.0-pre.5, which is when the addition was made, and move the cursor up and down to compare them.</p>
<h1 id="changelog">Changelog</h1>
<p>See a full changelog <a href="https://github.com/maplibre/maplibre-gl-js/blob/main/CHANGELOG.md#300">here</a>, including the list of potentially breaking changes.</p> </div> </div> </div>  <footer class="mt-auto"> <div class="container pb-4 pt-6"></div> <hr> <div class="container"> <div class="row py-3"> <div class="col-4"> <a href="" aria-label="MapLibre"> <img src="/_astro/maplibre-logo.wyLiUNdu_1QmCmX.svg" alt="MapLibre" width="120" height="30" loading="lazy" decoding="async"> </a> </div> <div class="col-8"> <div class="nav justify-content-end"> <a class="nav-link text-white" href="https://bsky.app/profile/maplibre.org" aria-label="MapLibre on Bluesky"> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="14" fill="none" viewBox="0 0 16 14"> <path fill="#fff" d="M3.62 1.163C5.391 2.482 7.3 5.155 8 6.59c.7-1.434 2.607-4.108 4.38-5.427 1.28-.951 3.353-1.688 3.353.655 0 .468-.27 3.93-.43 4.492-.551 1.955-2.563 2.453-4.353 2.151 3.128.528 3.924 2.275 2.206 4.021-3.264 3.318-4.691-.832-5.057-1.895C8.032 10.392 8 10.3 8 10.378c0-.077-.032.014-.099.209-.366 1.063-1.793 5.213-5.057 1.895-1.718-1.746-.922-3.493 2.206-4.02-1.79.301-3.802-.197-4.354-2.152-.159-.562-.43-4.024-.43-4.492C.267-.525 2.34.212 3.62 1.163Z"></path> </svg> </a> <a class="nav-link text-white" href="https://mastodon.social/@maplibre" aria-label="MapLibre on Mastodon"> <svg id="mas" viewBox="0 0 16 16" width="16" height="16" xmlns="http://www.w3.org/2000/svg"> <path fill="white" d="M 15.659 9.592 C 15.424 10.72 13.553 11.956 11.404 12.195 C 10.283 12.32 9.18 12.434 8.003 12.384 C 6.079 12.302 4.56 11.956 4.56 11.956 C 4.56 12.13 4.572 12.297 4.595 12.452 C 4.845 14.224 6.478 14.33 8.025 14.379 C 9.586 14.429 10.976 14.02 10.976 14.02 L 11.04 15.337 C 11.04 15.337 9.948 15.884 8.003 15.984 C 6.93 16.039 5.598 15.959 4.047 15.576 C 0.683 14.746 0.104 11.4 0.015 8.006 C -0.012 6.998 0.005 6.048 0.005 5.253 C 0.005 1.782 2.443 0.765 2.443 0.765 C 3.672 0.238 5.782 0.017 7.975 0 L 8.029 0 C 10.221 0.017 12.332 0.238 13.561 0.765 C 13.561 0.765 15.999 1.782 15.999 5.253 C 15.999 5.253 16.03 7.814 15.659 9.592 Z M 13.124 5.522 L 13.124 9.725 L 11.339 9.725 L 11.339 5.646 C 11.339 4.786 10.951 4.35 10.175 4.35 C 9.317 4.35 8.887 4.867 8.887 5.891 L 8.887 8.124 L 7.113 8.124 L 7.113 5.891 C 7.113 4.867 6.683 4.35 5.825 4.35 C 5.049 4.35 4.661 4.786 4.661 5.646 L 4.661 9.725 L 2.876 9.725 L 2.876 5.522 C 2.876 4.663 3.111 3.981 3.582 3.476 C 4.067 2.971 4.703 2.712 5.493 2.712 C 6.406 2.712 7.098 3.039 7.555 3.695 L 8 4.39 L 8.445 3.695 C 8.902 3.039 9.594 2.712 10.507 2.712 C 11.297 2.712 11.933 2.971 12.418 3.476 C 12.889 3.981 13.124 4.663 13.124 5.522 Z" style="stroke:none;stroke-miterlimit:10;fill-rule:evenodd;"></path> </svg> </a> <a class="nav-link text-white" href="https://twitter.com/maplibre" aria-label="MapLibre on X"> <svg width="16" height="16" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"></path> </svg> </a> <a class="nav-link text-white" href="https://www.linkedin.com/company/maplibre" aria-label="MapLibre on Linkedin"> <svg width="18" height="18" viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"> <g fill="none" fill-rule="evenodd"> <path d="M8,72 L64,72 C68.418278,72 72,68.418278 72,64 L72,8 C72,3.581722 68.418278,-8.11624501e-16 64,0 L8,0 C3.581722,8.11624501e-16 -5.41083001e-16,3.581722 0,8 L0,64 C5.41083001e-16,68.418278 3.581722,72 8,72 Z" fill="#fff"></path> <path d="M62,62 L51.315625,62 L51.315625,43.8021149 C51.315625,38.8127542 49.4197917,36.0245323 45.4707031,36.0245323 C41.1746094,36.0245323 38.9300781,38.9261103 38.9300781,43.8021149 L38.9300781,62 L28.6333333,62 L28.6333333,27.3333333 L38.9300781,27.3333333 L38.9300781,32.0029283 C38.9300781,32.0029283 42.0260417,26.2742151 49.3825521,26.2742151 C56.7356771,26.2742151 62,30.7644705 62,40.051212 L62,62 Z M16.349349,22.7940133 C12.8420573,22.7940133 10,19.9296567 10,16.3970067 C10,12.8643566 12.8420573,10 16.349349,10 C19.8566406,10 22.6970052,12.8643566 22.6970052,16.3970067 C22.6970052,19.9296567 19.8566406,22.7940133 16.349349,22.7940133 Z M11.0325521,62 L21.769401,62 L21.769401,27.3333333 L11.0325521,27.3333333 L11.0325521,62 Z" fill="#000"></path> </g> </svg> </a> <a class="nav-link text-white" href="https://github.com/MapLibre" aria-label="MapLibre on GitHub"> <svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 30 30"> <use href="img/github.svg#github"></use> </svg> </a> </div> </div> </div> </div> </footer> </body></html>