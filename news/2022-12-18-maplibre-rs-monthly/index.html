<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="map[]"><meta name=keywords content><meta name=description content><meta name=theme-color content="#fff"><meta property="og:image" content="https://maplibre.org/img/share-image.png"><meta property="og:image:width" content="1024"><meta property="og:image:height" content="512"><meta property="og:image:alt" content="MapLibre"><meta property="og:title" content="maplibre-rs monthly"><meta property="og:description" content><meta property="og:url" content="https://maplibre.org/news/2022-12-18-maplibre-rs-monthly/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@maplibre"><meta name=twitter:creator content="@maplibre"><meta name=twitter:title content="maplibre-rs monthly"><meta name=twitter:description content><meta name=twitter:image:src content="https://maplibre.org/img/share-image.png"><meta name=twitter:image:alt content="MapLibre"><link rel=me href=https://mastodon.social/@maplibre><link rel=stylesheet href=/style.min.fb20e75ad9ca28b026ee9c0b987a6064ae296549096f147ff4f131382365265c.css><link rel=stylesheet href=/mapbox-gl.731181d400d65a8b09d842f55b70bc4dc11010b15b8549e2c65a69d233fbdd2e.css><script type=text/javascript src=/main.20f321987eaf1a05f6c91437adad3e7d86fc01b66ed465e1199a462572b4f3c7.js></script><title>maplibre-rs monthly |
MapLibre</title></head><body><nav class="navbar navbar-expand-lg navbar-dark fixed-top
bg-navbar"><div class=container><a class=navbar-brand href=/ aria-label=MapLibre><svg aria-hidden="true" width="141" height="30" viewBox="0 0 141 30" xmlns="http://www.w3.org/2000/svg"><use href="/img/maplibre-logo.svg#maplibre-logo"/></svg></a><div class=d-flex><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarNavAltMarkup aria-controls=navbarNavAltMarkup aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button>
<a class="nav-link py-1 py-lg-0 d-flex align-items-center d-lg-none text-white" href=https://github.com/MapLibre aria-label="MapLibre organization on Github"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30"><use href="/img/github.svg#github"/></svg></a></div><div class="collapse navbar-collapse justify-content-end" id=navbarNavAltMarkup><div class=navbar-nav><li><a class=nav-link href=/about/>About</a></li><li><a class=nav-link href=/jobs/>Jobs</a></li><li><a class=nav-link href=/roadmap/>Roadmap</a></li><li><a class=nav-link href=/sponsors/>Sponsors</a></li><li><a class=nav-link href=/news/>News</a></li><li><a class=nav-link href=/projects/>Projects</a></li><li><a class=nav-link href=/community/>Community</a></li></div></div><a class="nav-link py-1 py-lg-0 d-none align-items-center d-lg-flex text-white" href=https://github.com/MapLibre aria-label="MapLibre organization on Github"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30"><use href="/img/github.svg#github"/></svg></a></div></nav><div class="container-fluid px-0 mb-6"><div class="row mx-0 bg-title text-center align-items-center"><h1 class="text-white pt-6">maplibre-rs monthly</h1></div></div><div class=container><div class=row><div class=post-meta-date><time datetime=" 2022-12-18">Dec 18, 2022</time>
<span>¬∑</span>
<span>5 minutes read</span></div><div>Categories:
<span class="badge bg-light"><a href=https://maplibre.org/categories/maplibre-rs/>maplibre-rs</a></span></div><div>Authors:
<span><span class="badge bg-light"><a href=https://maplibre.org/authors/maxammann/>Max Ammann</a></span></span></div></div><div class="row mt-4"><div><p><a href=https://github.com/maplibre/maplibre-rs target=_blank rel=noopener>maplibre-rs</a> is an upcoming and cross-platform vector map renderer written in Rust. If you want to get in touch with the developers, visit the <a href=https://matrix.to/#/#mapr:matrix.org target=_blank rel=noopener>#maplibre:matrix.org</a> chat or join the MapLibre (#maplibre and #maplibre-rs) community within the OpenStreetMap Slack. You can get an invitation <a href=https://slack.openstreetmap.us/ target=_blank rel=noopener>here</a>.</p><h2 id=-news>üì∞ News <a class=heading-link href=#-news></a></h2><p>Technically, this is not a &ldquo;monthly&rdquo; as I did not find the time in the past months to regularly write these.
A lot has happened in the past months, though!</p><p>At least three major features and a few quality-of-developer-life features are cooking and are soon ready for testing.
For better debugging I integrated <a href=https://github.com/emilk/egui target=_blank rel=noopener>egui</a> into maplibre-rs. This should make it easy to display statistics like the current FPS or selected feature on the map. I could also imagine that a style editor in the style of <a href=https://maputnik.github.io/ target=_blank rel=noopener>Maputnik</a> could be feasible.</p><p>Apart from egui, I also added a visualizing red border around tiles. This helped to improve the data loading performance of the renderer, as it became obvious which data loaded too slow.</p><figure><img class="w-50 p-3" src=/news/2022-12-18-maplibre-rs-monthly/egui_hud395d6a129939a90bfd43a494c38c04d_409147_1000x0_resize_q75_h2_box_3.webp alt="egui integration" width=1000px><figcaption>egui integration</figcaption></figure><p>In late summer, <a href=https://github.com/Drabble target=_blank rel=noopener>@Drabble</a> already started working on a proof-of-concept for extruded 3D buildings. The work required several rebases over the months, but it survived and looks stunning!
As per-feature rendering is currently missing, all buildings have the same height right now. I hope to change that in the near future.
I noticed that design changes are usually accompanied by multiple concrete problems.
As we integrate more features which are dependent on feature properties (building height, color properties, etc.) the required design changes will be uncovered.</p><figure><img class="w-50 p-3" src=/news/2022-12-18-maplibre-rs-monthly/extrusion_hud15ac4eef57aedd3bf4a4762ba6afb90_941382_1000x0_resize_q75_h2_box_3.webp alt="building extrusion" width=1000px><figcaption>3D building extrusion</figcaption></figure><p>In parallel <a href=https://github.com/Quillasp target=_blank rel=noopener>@Quillasp</a> worked on adding raster tile support to maplibre-rs. It already works on native platforms (Android, iOS, Linux, Windows) and in browsers. The decoding of the images is done using WebWorkers. In the future, the browser should be tasked with the decoding jobs.</p><figure><img class="w-50 p-3" src=/news/2022-12-18-maplibre-rs-monthly/raster_huf59b4b441cec3920de62bf0ff02859c6_1065896_1000x0_resize_q75_h2_box_3.webp alt="raster tile rendering" width=1000px><figcaption>Raster tiles</figcaption></figure><p>Last but not least, I ported the SDF font rendering from the maps-rs prototype by <a href=https://github.com/lseelenbinder target=_blank rel=noopener>Luke Seelenbinder</a>.
On the second try, it worked quite perfectly. Currently, there is no collision detection in place, which means that labels overlap while zooming in and out. Collision detection on its own is an interesting problem. On the OSM Slack we discussed whether this could be implemented on the GPU.
Current ideas for that are documented in a deck.gl <a href=https://github.com/visgl/deck.gl/issues/7374 target=_blank rel=noopener>#7374</a>.</p><figure><video class="w-50 p-3" src=sdf-rendering.webm autoplay muted loop></video><figcaption>Text Rendering using SDFs</figcaption></figure><p>All the above features are not yet merged into the main branch of maplibre-rs as further design changes need to happen.
For example, the management of GPU resources is very verbose right now. Additions of GPU resources and requires changes in some core
engine <code>struct</code>. To mitigate this, further abstractions need to be invented.
After those design changes and resolving all discussions in the PRs we can merge in the features.</p><p>Apart from those new features, <a href=https://github.com/kimpham54 target=_blank rel=noopener>kim pham</a> is currently working on parsing the MapLibre style specification, including its expressions.
Based on this work, the plan is that we generate statistics about the most frequently used style specification features.
This way we can create issues for all the missing features and prioritize them according to their usage.</p><p>Finally, I want to mention that maplibre-rs has now an RFC process described <a href=https://maplibre.org/maplibre-rs/docs/book/rfc/0001-rfc-process.html target=_blank rel=noopener>here</a>. Based on that, I wrote an RFC about how data is exchanged between WebWorkers and the main thread <a href=https://github.com/maplibre/maplibre-rs/pull/223 target=_blank rel=noopener>#223</a>. I think this is a great way to document progress. Let&rsquo;s see how that process will be used in the future!</p><h2 id=-housekeeping>üè† Housekeeping <a class=heading-link href=#-housekeeping></a></h2><p>The following will summarize what happened last week on GitHub.</p><h3 id=-merged-pull-requests>üéÅ Merged Pull Requests <a class=heading-link href=#-merged-pull-requests></a></h3><ul><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/227 target=_blank rel=noopener>#227</a> Improve processing by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>Tiles are processed now immediately, instead of distributing work over frames.</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/226 target=_blank rel=noopener>#226</a> Add debug lines and improve tile queuing by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>Red lines around tiles were added for debugging. Queuing of tiles has also been improved.</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/224 target=_blank rel=noopener>#224</a> Automatically choose texture format based on adapter by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>Texture formats are now selected based on what the GPU supports.</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/222 target=_blank rel=noopener>#222</a> Improve error handling by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>Complete rewrite of errors throughout maplibre-rs to follow best practices.</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/214 target=_blank rel=noopener>#214</a> Make writing rendered tiles to disk optional, and disable for bench by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>Benchmarks no longer write PNGs to disk.</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/213 target=_blank rel=noopener>#213</a> Fix tracy by using re-export by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br></p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/211 target=_blank rel=noopener>#211</a> Switch to own host for test-data by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br></p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/209 target=_blank rel=noopener>#209</a> Switch to powershell by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>Some windows goodies.</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/208 target=_blank rel=noopener>#208</a> justfile: automatically install wasm32 target for nightly toolchain by <a href=https://github.com/julienr target=_blank rel=noopener>@julienr</a><br></p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/206 target=_blank rel=noopener>#206</a> Clippy fixes by <a href=https://github.com/julienr target=_blank rel=noopener>@julienr</a><br></p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/195 target=_blank rel=noopener>#195</a> Create a matrix job for apple by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>Improves CI time by a factor of 3.</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/188 target=_blank rel=noopener>#188</a> Bootstrap RFCs and add initial RFC by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>We have now an official RFC process!</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/174 target=_blank rel=noopener>#174</a> New WASM executor by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>We are no longer restricted to use SharedArrayBuffer. This means maplibre-rs runs now on any website!</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/pull/149 target=_blank rel=noopener>#149</a> Define a minimum and maximum pitch by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br></p></li></ul><h3 id=-new-issues>üéÅ New Issues <a class=heading-link href=#-new-issues></a></h3><ul><li><p><a href=https://github.com/maplibre/maplibre-rs/issues/229 target=_blank rel=noopener>#229</a> Limit work done per frame by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>This should reduce frame drops.</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/issues/216 target=_blank rel=noopener>#216</a> Upgrade criterion and use cargo-criterion by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br></p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/issues/212 target=_blank rel=noopener>#212</a> Rendering does not work on Windows+Nvidia+Vulkan by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>This could need some reproduction by windows folks.</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/issues/201 target=_blank rel=noopener>#201</a> Upgrade Rust to 1.65 by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>New goodies!</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/issues/187 target=_blank rel=noopener>#187</a> maplibre-demo: High CPU and GPU usage on macOS while idle by <a href=https://github.com/vollkorntomate target=_blank rel=noopener>@vollkorntomate</a><br>Discussions about idling.</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/issues/185 target=_blank rel=noopener>#185</a> Separation of map rendering and input controls in different Rust crates by <a href=https://github.com/DerKarlos target=_blank rel=noopener>@DerKarlos</a><br>Discussion about input handling.</p></li><li><p><a href=https://github.com/maplibre/maplibre-rs/issues/182 target=_blank rel=noopener>#182</a> Flutter support by <a href=https://github.com/maxammann target=_blank rel=noopener>@maxammann</a><br>Just an idea :)</p></li></ul><h3 id=-current-discussions>üßµ Current Discussions <a class=heading-link href=#-current-discussions></a></h3><p>None</p><h3 id=-contributors>üëã Contributors <a class=heading-link href=#-contributors></a></h3><ul><li><a href=https://github.com/DerKarlos target=_blank rel=noopener>@DerKarlos</a> - Thanks for discussions about input handling!</li><li><a href=https://github.com/julienr target=_blank rel=noopener>@julienr</a> - Thanks for code improvements!</li><li><a href=https://github.com/Quillasp target=_blank rel=noopener>@Quillasp</a> - Thanks for raster tile rendering!</li><li><a href=https://github.com/vollkorntomate target=_blank rel=noopener>@vollkorntomate</a> - Thanks for raising a discussion about CPU/GPU usage!</li></ul></div></div></div><footer class=mt-auto><div class="container pb-4 pt-6"><a href=/ aria-label=MapLibre><svg aria-hidden="true" width="141" height="30" viewBox="0 0 141 30" xmlns="http://www.w3.org/2000/svg"><use href="/img/maplibre-logo-dark.svg#maplibre"/></svg></a></div><div class="container border-top border-gray"><div class="row py-3"><div class=col-sm-6><div class=nav><li><a class="nav-link text-black-50" href=/>MapLibre</a></li><li><a class="nav-link text-black-50" href=/jobs/>Jobs</a></li><li><a class="nav-link text-black-50" href=/sponsors/>Sponsors</a></li><li><a class="nav-link text-black-50" href=/projects/>Projects</a></li></div></div><div class=col-sm-1><div class="d-flex justify-content-center text-black-50 nav-link">CC0</div></div><div class="col-sm-2 flex"><div class="text-black-50 d-flex justify-content-center nav-link"><a class=text-black-50 href=https://github.com/maplibre/maplibre.github.io>GitHub</a>
@
<a class=text-black-50 href=#ZgotmplZ/commit/ef81d611cf4f82467767661cc80d00bfeba2eb4a>ef81d61</a></div></div><div class=col-sm-3><div class="nav justify-content-end"><a class="nav-link text-black-50" href=https://mastodon.social/@maplibre aria-label="MapLibre on Mastodon"><svg id="mas" viewBox="0 0 16 16" width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill="#979da6" d="M15.659 9.592C15.424 10.72 13.553 11.956 11.404 12.195 10.283 12.32 9.18 12.434 8.003 12.384 6.079 12.302 4.56 11.956 4.56 11.956 4.56 12.13 4.572 12.297 4.595 12.452c.25 1.772 1.883 1.878 3.43 1.927C9.586 14.429 10.976 14.02 10.976 14.02L11.04 15.337S9.948 15.884 8.003 15.984C6.93 16.039 5.598 15.959 4.047 15.576.683 14.746.104 11.4.015 8.006-.012 6.998.005 6.048.005 5.253.005 1.782 2.443.765 2.443.765 3.672.238 5.782.017 7.975.0H8.029c2.192.017 4.303.238 5.532.765.0.0 2.438 1.017 2.438 4.488.0.0.0310000000000006 2.561-.34 4.339zm-2.535-4.07V9.725H11.339V5.646c0-.86-.388-1.296-1.164-1.296C9.317 4.35 8.887 4.867 8.887 5.891V8.124H7.113V5.891C7.113 4.867 6.683 4.35 5.825 4.35c-.776.0-1.164.436-1.164 1.296V9.725H2.876V5.522c0-.859.235-1.541.706-2.046.485-.505 1.121-.764 1.911-.764C6.406 2.712 7.098 3.039 7.555 3.695L8 4.39l.445-.695C8.902 3.039 9.594 2.712 10.507 2.712 11.297 2.712 11.933 2.971 12.418 3.476 12.889 3.981 13.124 4.663 13.124 5.522z" style="stroke:none;stroke-miterlimit:10;fill-rule:evenodd"/></svg></a><a class="nav-link text-black-50" href=https://twitter.com/maplibre aria-label="MapLibre on Twitter"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><use href="/img/icon/twt.svg#twt"/></svg></a></div></div></div></div></footer></body></html>